<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <link rel="icon" type="image/png" sizes="64x64" href="favicon.png">
    <title>科学计算器 - MachineLearningCalculator</title>
    <link rel="stylesheet" href="assets/css/style.css">
</head>
<body>
    <div id="background-wrapper"></div>
    <div class="page-container">
        <a href="../../index.html" class="back-btn">← 返回首页</a>
        <div class="header">
            <h1 data-shadow='科学计算器'>科学计算器</h1>
            <p class="subtitle">支持加减乘除、幂运算、三角函数、对数、求导、方程求解、单位转换</p>
            <br><br><br>
        </header>

        <div class="container">
            <div class="calc-grid">
                <section class="calculator">
                    <div id="display" class="display" contenteditable="true" spellcheck="false">0</div>
                    <div class="action-buttons">
                        <button id="evalBtn" class="btn btn-primary">= 计算</button>
                        <button id="clearBtn" class="btn btn-secondary">清除</button>
                        <button id="backBtn" class="btn btn-secondary">退格</button>
                    </div>

                    <div class="buttons">
                        <!-- 行1 -->
                        <button class="btn-calc" data-val="7">7</button>
                        <button class="btn-calc" data-val="8">8</button>
                        <button class="btn-calc" data-val="9">9</button>
                        <button class="btn-calc btn-op" data-val="/">÷</button>
                        <button class="btn-calc btn-op" data-fn="sqrt">√</button>
                        <button class="btn-calc btn-op" data-fn="pow">^</button>

                        <!-- 行2 -->
                        <button class="btn-calc" data-val="4">4</button>
                        <button class="btn-calc" data-val="5">5</button>
                        <button class="btn-calc" data-val="6">6</button>
                        <button class="btn-calc btn-op" data-val="*">×</button>
                        <button class="btn-calc btn-op" data-fn="pi">π</button>
                        <button class="btn-calc btn-op" data-fn="fact">n!</button>

                        <!-- 行3 -->
                        <button class="btn-calc" data-val="1">1</button>
                        <button class="btn-calc" data-val="2">2</button>
                        <button class="btn-calc" data-val="3">3</button>
                        <button class="btn-calc btn-op" data-val="-">−</button>
                        <button class="btn-calc btn-op" data-fn="mod">mod</button>
                        <button class="btn-calc btn-op" data-fn="percent">%</button>

                        <!-- 行4 -->
                        <button class="btn-calc" data-val="0">0</button>
                        <button class="btn-calc" data-val=".">.</button>
                        <button class="btn-calc" data-val="(">(</button>
                        <button class="btn-calc" data-val=")">)</button>
                        <button class="btn-calc btn-op" data-val="+">+</button>
                        <button class="btn-calc btn-op" data-fn="ans">Ans</button>

                        <!-- 行5 高级函数 -->
                        <button class="btn-calc" data-fn="sin">sin</button>
                        <button class="btn-calc" data-fn="cos">cos</button>
                        <button class="btn-calc" data-fn="tan">tan</button>
                        <button class="btn-calc" data-fn="log">log</button>
                        <button class="btn-calc" data-fn="ln">ln</button>
                        <button class="btn-calc" data-fn="sqrt2">sqrt</button>
                    </div>

                    <div class="advanced-controls">
                        <button id="deriveBtn" class="btn btn-secondary">求导</button>
                        <button id="solveBtn" class="btn btn-secondary">求解</button>
                        <input id="solveVar" placeholder="变量 (默认 x)" class="input-field" />
                        <input id="solveGuess" placeholder="初始值" class="input-field" />
                    </div>
                </section>

                <aside class="side-panel">
                    <div class="field">
                        <label>设置</label>
                        <div class="settings-row">
                            <label>小数位</label>
                            <input id="precision" type="number" min="0" max="20" value="6" class="input-field small" />
                            <label>角度</label>
                            <select id="angleMode" class="input-field small">
                                <option value="rad">弧度</option>
                                <option value="deg">角度</option>
                            </select>
                        </div>
                    </div>

                    <div class="field">
                        <label>单位转换</label>
                        <input id="unitInput" placeholder="10 cm to m" class="input-field" />
                        <button id="convertBtn" class="btn btn-secondary">转换</button>
                        <div id="unitResult" class="result-text"></div>
                    </div>

                    <div class="field">
                        <label>历史记录</label>
                        <div id="history" class="history"></div>
                    </div>

                    <div class="field">
                        <label>说明</label>
                        <div class="info-text">支持表达式输入（例如 <code>2*(3+sin(pi/4))</code>），使用小写函数名。求导使用符号计算（Algebrite），方程求解为单变量数值求解。</div>
                    </div>
                    <div class="field">
                        <label>更多功能</label>
                        <a href="more.html" class="btn btn-primary">查看更多</a>
                    </div>
                </aside>
            </div>
        </div>
    </div>

    <!-- 引入 math.js（数值/单位/分数）、Algebrite（符号运算）以及本地逻辑脚本 -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/algebrite/1.5.0/algebrite.min.js"></script>
    <script src="assets/js/calculator.js"></script>
</body>
</html>
