<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <link rel="icon" type="image/png" sizes="64x64" href="favicon.png">
    <title>通用文本处理工具 - TextGrep</title>
    <link rel="stylesheet" href="./assets/css/style.css">
</head>
<body>
    <div class="theme-toggle">
        <input type="checkbox" id="themeToggle" class="theme-toggle__checkbox">
        <label for="themeToggle" class="theme-toggle__btn">
            <span class="theme-toggle__feature"></span>
        </label>
    </div>

    <div id="background-wrapper"></div>
    <div class="page-container">
        <div class="nav-bar">
            <a href="../../index.html" class="back-link">← 退出工具</a>
            <button id="backToHomeBtn" class="back-link" style="display: none; background:none; border:none; cursor:pointer;">← 返回功能选择</button>
        </div>

        <div class="header">
            <h1 data-shadow='文本处理工具箱'>文本处理工具箱</h1>
            <p class="subtitle" id="mainSubtitle">请选择您需要的功能</p>
        </div>

        <div class="container">

            <div id="landing-page" class="landing-grid">
                <div class="tool-card" onclick="selectMode('search')">
                    <div class="tool-icon">🔍</div>
                    <h3>文本搜索</h3>
                    <p>上传文档，按分隔符切分，支持批量关键词搜索与正则匹配。</p>
                </div>
                <div class="tool-card" onclick="selectMode('list')">
                    <div class="tool-icon">📝</div>
                    <h3>文本转列表</h3>
                    <p>将长文本按指定字符（如逗号、分号）分割为列表，支持智能类型识别。</p>
                </div>
            </div>

            <div id="tool-interface" style="display: none;">
                
                <div class="section" id="step1">
                    <h2>步骤 1: 上传或输入文本</h2>
                    <div class="upload-area">
                        <div class="file-upload">
                            <div class="file-upload-area" id="fileUploadArea">
                                <input type="file" id="fileInput" accept=".txt,.doc,.docx,.pdf" multiple style="display: none;">
                                <div class="upload-icon">📁</div>
                                <p class="upload-text">点击批量选择文件，或拖拽文件到此处</p>
                                <p class="upload-hint">支持 .txt, .docx, .pdf 格式文件</p>
                                <span id="fileName" class="file-name"></span>
                            </div>
                        </div>
                        <div class="divider">和/或</div>
                        <div class="text-input">
                            <textarea id="textInput" placeholder="直接在此粘贴文本内容...&#10;&#10;提示：可以同时选择文件和粘贴文本，两者将自动合并"></textarea>
                        </div>
                    </div>
                    <button id="loadTextBtn" class="btn btn-primary">载入文本</button>
                </div>

                <div class="section" id="step2" style="display: none;">
                    <h2 id="step2Title">步骤 2: 设置分隔符</h2>
                    <div class="delimiter-options">
                        <label class="radio-option">
                            <input type="radio" name="delimiter" value="newline" checked>
                            <span>单个换行符 (\n)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="delimiter" value="emptyline">
                            <span>空行/双换行 (\n\n)</span>
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="delimiter" value="comma">
                            <span>逗号分隔 ( , )</span>
                        </label>
                        <div class="radio-option custom-option">
                            <input type="radio" id="delimiterCustom" name="delimiter" value="custom">
                            <label for="delimiterCustom">自定义：</label>
                            <input type="text" id="customDelimiter" placeholder="输入分隔符">
                            
                            <div class="advanced-controls" id="delimiterAdvanced" style="margin-left: 10px;">
                                <label class="checkbox-inline" title="启用正则表达式进行分隔">
                                    <input type="checkbox" id="delimiterRegex">
                                    <span>正则</span>
                                </label>
                                <label class="checkbox-inline" title="区分大小写">
                                    <input type="checkbox" id="delimiterCase">
                                    <span>区分大小写</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="processing-controls">
                        <label class="checkbox-inline main-option" title="取消勾选以保留所有重复数据">
                            <input type="checkbox" id="removeDuplicates" checked>
                            <span>去除重复项</span>
                        </label>
                        <button id="parseTextBtn" class="btn btn-primary">开始处理</button>
                    </div>
                    <div id="dataPreview" class="data-preview"></div>
                </div>

                <div class="section" id="step3" style="display: none;">
                    <h2 id="step3Title">步骤 3: 结果处理</h2>
                    
                    <div id="searchModeUI" style="display: none;">
                        <div class="search-area">
                            <div class="search-controls-bar">
                                <label class="checkbox-inline">
                                    <input type="checkbox" id="searchRegex"> <span>正则匹配</span>
                                </label>
                                <label class="checkbox-inline">
                                    <input type="checkbox" id="searchCase"> <span>区分大小写</span>
                                </label>
                            </div>
                            <textarea id="searchInput" placeholder="输入要搜索的内容...&#10;支持批量搜索：每行一个关键词"></textarea>
                            <div class="search-actions">
                                <button id="searchBtn" class="btn btn-success">开始搜索</button>
                                <button id="downloadSearchResultsBtn" class="btn btn-secondary" disabled>下载结果</button>
                            </div>
                        </div>
                        <div id="searchResults" class="search-results"></div>
                    </div>

                    <div id="listModeUI" style="display: none;">
                        <div class="list-output-area">
                            <div class="list-options-bar">
                                <span class="label-text">输出格式：</span>
                                <label class="radio-option inline-radio">
                                    <input type="radio" name="listFormat" value="string" checked>
                                    <span>纯字符串 (["a", "1"])</span>
                                </label>
                                <label class="radio-option inline-radio">
                                    <input type="radio" name="listFormat" value="smart">
                                    <span>智能识别 (["a", 1, 'c'])</span>
                                </label>
                            </div>
                            
                            <div class="result-header success" id="listStats"></div>
                            <textarea id="listOutput" readonly class="result-textarea" placeholder="转换结果将显示在这里..."></textarea>
                            <div class="search-actions" style="margin-top:15px;">
                                <button id="copyListBtn" class="btn btn-primary">复制列表</button>
                                <button id="downloadListBtn" class="btn btn-secondary">下载列表 (.txt)</button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <footer class="footer">
        <p>Copyright © 2024 Tooltopia. All Rights Reserved.</p>
        <p>Designed by DSTBP</p>
    </footer>

    <script src="./assets/js/theme-toggle.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mammoth/1.6.0/mammoth.browser.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script src="./assets/js/script.js"></script>
</body>
</html>